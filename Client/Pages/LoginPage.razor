@using festival.Shared.Services
@inject NavigationManager NavigationManager

@page "/login"

<h3>Login</h3>

@if (showSelection)
{
    <button @onclick="() => ChooseRole(true)">Coordinator</button>
    <button @onclick="() => ChooseRole(false)">Volunteer</button>
}
else
{
    if (isCoordinator)
    {
        <label for="nameSelect">Vælg dit navn:</label>
        <select id="nameSelect" @onchange="CoordinatorSelected">
            <option value="">Vælg...</option>
            @foreach (var name in coordinatorNames)
            {
                <option value="@name">@name</option>
            }
        </select>
    }
    else
    {
        <button @onclick="CreateNewVolunteer">Opret ny frivillig</button>
        <button @onclick="() => LoginAsVolunteer()">Eksisterende frivillig</button>
    }

    if (showPasswordEntry)
    {
        <label for="password">Adgangskode:</label>
        <input type="password" id="password" />
        <button @onclick="Login">Login</button>
    }
}

@code {
    private bool showSelection = true;
    private bool isCoordinator = false;
    private bool showPasswordEntry = false;
    private string selectedRole = "";
    private string[] coordinatorNames = { "Coordinator 1", "Coordinator 2" }; // Dette kunne komme fra en database eller en service

    private void ChooseRole(bool coordinator)
    {
        isCoordinator = coordinator;
        showSelection = false;
        showPasswordEntry = true; // Antager at vi viser password indgangen uanset hvad
        selectedRole = coordinator ? "Coordinator" : "Volunteer";
    }

    private void CoordinatorSelected(ChangeEventArgs e)
    {
        // Antag at denne metode bliver kaldt, når en koordinator vælges fra dropdown-menuen
        showPasswordEntry = true;
    }

    private void CreateNewVolunteer()
    {
        // Her vil du navigere brugeren til en side, hvor de kan oprette en ny frivillig
        NavigationManager.NavigateTo("/signup");
    }

    private void LoginAsVolunteer()
    {
        // Dette er en ekstra metode til at håndtere eksisterende frivillig login
        selectedRole = "Volunteer";
        showPasswordEntry = true;
    }

    private void Login()
    {
        /*
        // Her vil du logge brugeren ind med den valgte rolle
        AuthService.LoginAs(selectedRole);
        if (AuthService.IsCoordinator())
        {
            NavigationManager.NavigateTo("/coordinatorpage");
        }
        else if (AuthService.IsVolunteer())
        {
            NavigationManager.NavigateTo("/volunteerpage");
        }
    */
    }

}